{% extends '_base.html' %}

{% block title %}add book{% endblock %}

{% block body_class %} class="page-view add-view dashboard"{% endblock %}

{% block extra_javascript %}
    <script type="text/javascript" charset="utf-8" src="/javascript/librarian.js"></script>
    <script type="text/javascript" charset="utf-8" src="/javascript/json2.js"></script>
    AMD
    <script type="text/javascript">
    $(document).ready(function() {
        $("#form_search_book").submit(function() {
            get_book_info("{% url api:api_dispatch_list api_name="v2" resource_name="books/goodreads" %}", document.getElementById("id_isbn").value);
            return false;
        });

        $("#form_add_book").submit(function() {
            put_book_info(this,"{% url api:api_dispatch_list api_name="v2" resource_name="books/book" %}");
            return false;
        });
    });
    </script>
{% endblock %}

{% block content %}
    <div class="content">
        <form method="POST" id="form_search_book">{% csrf_token %}
            <p>
                <label for="id_isbn">ISBN:</label>
                <input type="text" name="isbn" id="id_isbn" value="{{ book.isbn }}" />
                <input type="submit" value="Search" class="submit-large" /><img src="/images/loading.gif">
            </p>
        </form>


        <div class="book-main">
            {% if book_form.cover_url.value %}
                <img src="{{ book_form.cover_url.value }}">
            {% endif %}
            <form method="POST" id="form_add_book">
            <ul class="forms">
                {{ book_form.as_ul }}
            </ul>
            <hr />

            {% if book.temp_cover_url %}
                <input type="hidden" name="cover_url" value="{{ book.temp_cover_url }}" />
            {% endif %}
            {% csrf_token %}
            <p>
                <button id="btn_add_book">Add {{ book.title }}</button>
            </p>
            </form>
        </div>
   </div>
{% endblock %}

{% block rail %}
    <h1>Search </h1>
{% endblock %}